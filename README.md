# env0-opa-exec-plugin
This env0 OPA plugin allows you to run `opa exec` on a bundle directory as part of a custom flow. To use this plugin, you will need to use version 2 of `env0.yml`.
  
## Inputs

The OPA plugin accepts the following inputs:

* decision - The specific true/false decision to evaluate with `opa exec`. If not specified opa will evaluate the default decision.
* flags - A string containing additional flags as one string
* bundle_path (required) - the path to your bundle directory (the root folder is your project's root folder)
* path (required) - the path to the input file to be evaluated by `opa exec`


## Example Usage

In this example we will run `opa exec` with our own rego file after the "Terraform Plan" step of a deploy, on the Terraform plan output
generated by env0. We will call that step "My Step Name":

```yaml
version: 2
deploy:
  steps:
    terraformPlan:
      after:
        - name: My Step Name # The name that will be presented in the UI for this step
          use: https://github.com/satoms/env0-opa-exec-plugin
          inputs:
            flags: --fail
            decision: terraform/analysis/authz
            bundle_path: policy/
            path: $ENV0_TF_PLAN_JSON

```

## Further Reading

[https://www.openpolicyagent.org/docs/latest/cli/#opa-exec](https://www.openpolicyagent.org/docs/latest/cli/#opa-exec)
